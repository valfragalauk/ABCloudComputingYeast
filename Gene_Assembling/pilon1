#!/bin/bash
#SBATCH --job-name=pilon_SY14
#SBATCH --output=/scratch/grp/msc_appbio/Group2_ABCC/Gene_Assembling/logs/pilon_SY14_%j.out
#SBATCH --error=/scratch/grp/msc_appbio/Group2_ABCC/Gene_Assembling/logs/pilon_SY14_%j.err
#SBATCH --cpus-per-task=4
#SBATCH --mem=120G
#SBATCH --time=8:00:00
#SBATCH --partition=msc_appbio

# Load required modules (adjust based on your HPC environment)
module load pilon  # or module load java if pilon needs to be called directly

# Run Pilon
pilon --genome SY14.contigs.fasta \
  --frags SY14_illumina_mapped.bam \
  --output SY14_polished \
  --changes --vcf \
  --threads 4

echo "Pilon polishing completed!"

# Verification
echo "Number of contigs in polished assembly:"
grep -c ">" SY14_polished.fasta

echo "Total assembly size:"
grep -v ">" SY14_polished.fasta | tr -d '\n' | wc -c

echo "Number of corrections made:"
wc -l SY14_polished.changes
